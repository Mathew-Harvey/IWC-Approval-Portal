# Render.com Deployment Configuration
# IWC Approval Portal

services:
  - type: web
    name: iwc-approval-portal
    runtime: node
    region: singapore
    plan: free
    buildCommand: npm install && npx prisma generate && npx prisma db push
    startCommand: npm start
    healthCheckPath: /api/health
    autoDeploy: true
    
    envVars:
      - key: NODE_ENV
        value: production
      
      # Database - auto-connected from Render database
      - key: DATABASE_URL
        fromDatabase:
          name: iwc-portal-db
          property: connectionString
      
      # Session Secret - auto-generated
      - key: SESSION_SECRET
        generateValue: true
      
      # Client URL for CORS (your Render app URL)
      # Update this to your actual Render URL after first deploy
      - key: CLIENT_URL
        value: https://iwc-approval-portal.onrender.com
      
      # =============================================
      # SET THESE MANUALLY IN RENDER DASHBOARD:
      # =============================================
      
      # Clerk Authentication (from https://dashboard.clerk.com)
      - key: CLERK_PUBLISHABLE_KEY
        sync: false
      - key: CLERK_SECRET_KEY
        sync: false
      
      # External APIs (optional)
      - key: MARINESIA_API_KEY
        sync: false
      - key: AISSTREAM_API_KEY
        sync: false

databases:
  - name: iwc-portal-db
    databaseName: iwc_portal
    plan: free
    region: singapore
    postgresMajorVersion: "17"
